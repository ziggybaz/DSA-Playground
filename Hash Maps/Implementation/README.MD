Disclaimer: just a lay implementation, nothing complex, most of it obtained through research.
